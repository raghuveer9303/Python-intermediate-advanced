-- Window Functions Exercises

-- Exercise 1: Running Total
-- Calculate running total of sales amount by date
-- Table: sales
-- Expected: date, amount, running_total

-- TODO: Your query here


-- Exercise 2: Moving Average
-- Calculate 3-day moving average of sales amount
-- Table: sales
-- Expected: date, amount, moving_avg_3days

-- TODO: Your query here


-- Exercise 3: Ranking Employees
-- Rank employees by salary within each department
-- Table: employees
-- Expected: name, department, salary, rank

-- TODO: Your query here


-- Exercise 4: Previous Day Sales
-- Get sales amount and previous day's amount
-- Table: sales
-- Expected: date, amount, prev_amount

-- TODO: Your query here


-- Exercise 5: Top N Per Group
-- Get top 2 employees by salary in each department
-- Table: employees
-- Expected: name, department, salary

-- TODO: Your query here
-- Hint: Use ROW_NUMBER() or DENSE_RANK()


-- Exercise 6: Percentile Ranking
-- Calculate percentile rank of student scores within each subject
-- Table: students
-- Expected: name, subject, score, percentile_rank

-- TODO: Your query here
-- Hint: Use PERCENT_RANK() or manual calculation


-- Exercise 7: Difference from Average
-- Calculate difference between sales amount and average amount
-- Table: sales
-- Expected: date, amount, avg_amount, difference

-- TODO: Your query here


-- Exercise 8: First and Last Value
-- Get first and last sale amount for each product
-- Table: sales
-- Expected: product_id, first_amount, last_amount

-- TODO: Your query here


-- Exercise 9: Cumulative Percentage
-- Calculate cumulative percentage of sales
-- Table: sales
-- Expected: date, amount, cumulative_percentage

-- TODO: Your query here


-- Exercise 10: Row Number vs Rank
-- Show difference between ROW_NUMBER, RANK, and DENSE_RANK
-- Table: students (use Math scores)
-- Expected: name, score, row_number, rank, dense_rank

-- TODO: Your query here

